<!--moiauuuuu-->
{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renovaci√≥n de Matr√≠cula</title>

    <link rel="stylesheet" href="{% static 'partida/css/renovacionsingin.css' %}">
    <!--Boostrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!--Sweetalert-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!--Iconos-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!--Animaciones-->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <style>

:root{
  --bg-dark: #071128;
  --panel-bg: rgba(255,255,255,0.06);
  --panel-border: rgba(255,255,255,0.12);
  --accent: #1f7ae0;
  --accent-2: #519dff;
  --success: #29dd66;
  --danger: #e04b4b;
  --glass-radius: 14px;
  --elev-sm: 0 6px 20px rgba(2,8,23,0.55);
  --elev-md: 0 12px 38px rgba(2,8,23,0.6);
  --muted: #9aa8c7;
  --text-light: #eaf2ff;
  --text-soft: #c6d6ee;
  --white-10: rgba(255,255,255,0.10);
  --shadow-blue: 0 8px 28px rgba(31, 122, 224, 0.12);
  --imagen1: url('{% static "partida/img/1.png" %}');
  --imagen2: url('{% static "partida/img/2.png" %}');
  --imagen3: url('{% static "partida/img/3.png" %}');
  --imagen4: url('{% static "partida/img/4.png" %}');
  --imagen5: url('{% static "partida/img/5.png" %}');
  --imagen6: url('{% static "partida/img/6.png" %}');
  --imagen7: url('{% static "partida/img/7.jpg" %}');
  --imagen8: url('{% static "partida/img/8.jpg" %}');
  --imagen9: url('{% static "partida/img/9.jpg" %}');
  --imagen10: url('{% static "partida/img/10.jpg" %}');
  --imagen11: url('{% static "partida/img/11.jpg" %}');
}

/* Page background image + dark overlay */
html,body{height:100%}
body{
  margin:0;
  padding:0;
  font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  color:var(--text-light);
  background: var(--imagen8) center/cover fixed no-repeat;
  background-color: var(--bg-dark);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* dark overlay for better contrast */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background: linear-gradient(180deg, rgba(3,10,28,0.6) 0%, rgba(3,10,28,0.75) 100%);
  z-index:0;
}

/* Page container */
.page{
  position:relative;
  z-index:1;
  max-width: 1000px;
  margin: 36px auto;
  padding: 36px 20px;
}



/* Title box styling */
.title-box{
  background: linear-gradient(180deg, rgba(13,32,56,0.55), rgba(6,18,36,0.6));
  border: 1px solid rgba(255,255,255,0.06);
  text-align:center;
}

/* Headings */
.title{
  font-size: 30px;
  font-weight:800;
  margin:0 0 6px 0;
  color:var(--text-light);
  letter-spacing:-0.3px;
}
.subtitle{
  margin:0;
  color:var(--text-soft);
  font-size:15px;
}

/* Info box h5 */
.info-box h5{
  font-size:18px;
  margin:0 0 8px 0;
  color:var(--text-light);
  font-weight:700;
}

/* Status styles (preserve classes) */
.status-active{
  border-left: 6px solid var(--success) !important;
  background: linear-gradient(90deg, rgba(41,221,102,0.06), rgba(10,30,12,0.03));
}
.status-inactive{
  border-left: 6px solid var(--danger) !important;
  background: linear-gradient(90deg, rgba(224,75,75,0.06), rgba(36,10,12,0.03));
}

/* Profile area */
.profile{
  display:flex;
  gap:18px;
  align-items:center;
}
.profile img, .profile .avatar-fallback{
  width:96px;
  height:96px;
  border-radius:50%;
  object-fit:cover;
  border: 3px solid rgba(255,255,255,0.06);
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  box-shadow: 0 6px 18px rgba(2,8,23,0.6);
}

/* profile texts */
.profile-name{
  margin:0;
  font-size:20px;
  font-weight:800;
  color:var(--text-light);
}
.profile-info{
  margin:4px 0;
  color:var(--text-soft);
  font-size:14px;
}

/* Tables */
.table{
  background: #ffffff;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid #e3e8ef;
}

.table th{
  background: #f1f5fb;
  color: #0d1b2a;
  padding: 12px;
  font-weight: 700;
  font-size: 15px;
  border-bottom: 1px solid #d6dce5;
}

.table td{
  padding: 12px;
  color: #1b2636;
  background: #ffffff;
  border-bottom: 1px solid #eef1f5;
}

.table tr:last-child td{
  border-bottom: none;
}

/* Form controls (inputs, selects, file inputs) */
.form-control, .form-select, input[type="text"], input[type="tel"], input[type="email"], input[type="file"]{
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.06);
  color: var(--text-light);
  padding:10px 12px;
  border-radius:10px;
  transition: box-shadow .22s, border-color .22s, transform .18s;
}
.form-control:focus, .form-select:focus, input[type="text"]:focus{
  outline:none;
  border-color: var(--accent);
  box-shadow: 0 6px 20px rgba(31,122,224,0.12);
  transform: translateY(-2px);
}

/* Readonly style */
[readonly]{
  background: rgba(255,255,255,0.02) !important;
  color: var(--text-soft) !important;
  pointer-events: none;
}

/* Cards (cards used in form areas) */
.card{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid rgba(255,255,255,0.04);
  border-radius: 10px;
  box-shadow: 0 6px 18px rgba(2,8,23,0.35);
}
.card-header{
  background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-bottom: 1px solid rgba(255,255,255,0.03);
}

/* File input small helper */
.file-requirements{
  color:var(--muted);
  font-size:12px;
  margin-top:6px;
}

/* Buttons */
.btn-enviar, .btn-blue{
  display:inline-block;
  width:100%;
  padding:12px 14px;
  border-radius:10px;
  border: none;
  font-weight:800;
  cursor:pointer;
  color: #fff;
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  box-shadow: var(--shadow-blue);
  transition: transform .18s, box-shadow .18s;
}
.btn-enviar:hover, .btn-blue:hover{
  transform: translateY(-3px);
  box-shadow: 0 18px 40px rgba(31,122,224,0.18);
}

/* Secondary link button */
.btn-regresar{
  display:inline-block;
  padding:10px 18px;
  color:var(--text-soft);
  background: transparent;
  border-radius:8px;
  text-decoration:none;
  border:1px solid rgba(255,255,255,0.04);
  transition: all .18s;
}
.btn-regresar:hover{
  color:var(--text-light);
  transform: translateY(-2px);
  box-shadow: 0 8px 22px rgba(2,8,23,0.45);
}

/* Validation */
.is-invalid{ border-color:#dc3545 !important; box-shadow: 0 8px 20px rgba(220,53,69,0.08) !important; }
.is-valid{ border-color:#28a745 !important; box-shadow: 0 8px 20px rgba(40,167,69,0.06) !important; }
.invalid-feedback{ display:block; color:#ffcccc; font-weight:600; margin-top:8px; }

/* Responsive */
@media (max-width: 768px){
  .profile{
    flex-direction:row;
    gap:12px;
    align-items:center;
  }
  .page{ padding: 20px 12px; }
  .info-box, .form-box{ padding:18px; margin:18px 12px; }
}

/* small helpers */
.text-muted { color: var(--muted) !important; }
.small { font-size:0.85rem; color:var(--text-soft); }

/* Quick fade-in */
[data-aos] { opacity: 0; transform: translateY(6px); transition: opacity .45s ease, transform .45s ease; }
[data-aos].aos-animate { opacity:1; transform: translateY(0); }

/* ===== BANNER INFORMATIVO ===== */
.info-banner {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, #1f6feb 0%, #0d47a1 100%);
    color: white;
    padding: 12px 20px;
    z-index: 1000;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    display: flex;
    align-items: center;
    justify-content: space-between;
    animation: slideDown 0.5s ease-out;
}

@keyframes slideDown {
    from {
        transform: translateY(-100%);
    }
    to {
        transform: translateY(0);
    }
}

.info-banner-content {
    display: flex;
    align-items: center;
    gap: 15px;
    flex: 1;
    justify-content: center;
}

.info-banner-icon {
    font-size: 24px;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

.info-banner-text {
    font-size: 15px;
    font-weight: 500;
}

.info-banner-close {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.3s;
}

.info-banner-close:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Ajustar margen superior para que el contenido no quede detr√°s del banner */
.page {
    margin-top: 60px; /* Ajusta seg√∫n la altura del banner */
}

/* SELECT con texto negro */
select,
.form-select {
    background-color: #ffffff !important;
    color: #0f1a2a !important;
    border: 1px solid #ccd3df !important;
}

/* Texto dentro del SELECT en negro */
select option {
    color: #0f1a2a !important;
    background: #ffffff !important;
}

/* INPUTS TIPO NUMBER Y TEXT NUM√âRICOS */
input[type="number"], .numeric-input {
    background-color: #ffffff !important;
    color: #0f1a2a !important;
    border: 1px solid #ccd3df !important;
}

/* Placeholder en gris oscuro */
select option[disabled],
input::placeholder {
    color: #6b7a8c !important;
}

    </style>
</head>

<body>
     <!-- BANNER INFORMATIVO -->
    <div class="info-banner" id="infoBanner">
        <div class="info-banner-content">
            <div class="info-banner-icon">üìã</div>
            <div class="info-banner-text">
                <strong>Importante:</strong> Por favor, revisa y actualiza <strong>TODOS los campos marcados</strong> si tu informacion esta bien debes hacer click en cada campo antes de enviar
                para completar tu renovaci√≥n. Los campos en gris no se pueden modificar.<br>
                <br>
                Todos los documetos a subir son obligatorios debes de subirlos para poder realizar la renovaci√≥n.</strong>.
            </div>
        </div>
        <button class="info-banner-close" id="closeBanner">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <div class="page">
        <!-- PERFIL DEL ALUMNO -->
        <div class="box">
            <div class="profile">
                {% if alumno.foto %}
                <img src="{{ alumno.foto.url }}" alt="Foto de {{ persona.nom1_persona }}"
                    style="width: 100px; height: 100px; background: #30363d; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                {% else %}
                <div
                    style="width: 100px; height: 100px; background: #30363d; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-user fa-2x" style="color: #8b949e;"></i>
                </div>
                {% endif %}

                <div>
                    <h2 class="profile-name text-white">{{ persona.nom1_persona }} {{ persona.ape1_persona }} ‚öΩ</h2>

                    <p class="profile-info">
                        <strong>ID:</strong> {{ persona.id_persona }} |
                        <strong>Edad:</strong> {{ edad }} a√±os |
                    </p>

                    <p class="profile-info">
                        Contacto: {{ persona.tel_persona|default:"Sin tel√©fono" }} |
                        Email: {{ persona.email_persona|default:"Sin email" }}
                    </p>

                    <p class="profile-info">
                        Miembro desde: {{ matriculas_anteriores.last.fecha_inicio|date:"d M, Y"|default:"Nueva renovaci√≥n" }}
                    </p>
                </div>
            </div>
        </div>

        <!-- HISTORIAL DE MATR√çCULAS -->
        <div class="box">
            <h3 class="table-title text-white">Historial de Matr√≠culas üìä</h3>

            <table class="table">
                <tr>
                    <th>A√±o</th>
                    <th>Categor√≠a</th>
                    <th>Estado</th>
                    <th>C√≥digo</th>
                </tr>
                {% for matricula in matriculas_anteriores %}
                <tr>
                    <td>{{ matricula.fecha_inicio.year }}</td>
                    <td>{{ matricula.fk_categoria.nom_categoria }}</td>
                    <td>
                        {% if matricula.estado_matricula %}
                        <span style="color: #3fb950;">Activa</span>
                        {% else %}
                        <span style="color: #8b949e;">Finalizada</span>
                        {% endif %}
                    </td>
                    <td><code>{{ matricula.codigo_fin_periodo|default:"-" }}</code></td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" style="text-align: center; color: #8b949e;">No hay matr√≠culas anteriores</td>
                </tr>
                {% endfor %}
            </table>
        </div>

        <!-- FORMULARIO DE RENOVACI√ìN COMPLETO -->
        <div class="box">
            <h3 class="form-title text-white">Renovar Matr√≠cula para el A√±o {{ ano_siguiente }}</h3>

            {% if messages %}
            <div class="container mt-3">
                {% for message in messages %}
                <div class="alert 
                    {% if message.tags == 'error' %}alert-danger
                    {% else %}alert-{{ message.tags }}{% endif %} 
                    alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <form method="POST" enctype="multipart/form-data" id="renovacionForm">
                {% csrf_token %}

                <!-- Informaci√≥n de Identificaci√≥n (NO EDITABLE) -->
                <div class="card mb-3">
                    <div class="card-header bg-secondary text-white">
                        <h6 class="mb-0">Documentos de Identificaci√≥n (No editable)</h6>
                    </div>
                    <div class="card-body">
                        <div class="row mb-2">
                            <div class="col-md-4">
                                <label>Tipo de Identificaci√≥n</label>
                                <input type="text" value="{{ persona.get_tipo_identidad_display }}" class="form-control"
                                    readonly style="background-color: #2a2f3b;">
                            </div>
                            <div class="col-md-4">
                                <label>N√∫mero de Identificaci√≥n</label>
                                <input type="text" value="{{ persona.id_persona }}" class="form-control" readonly
                                    style="background-color: #2a2f3b;">
                            </div>
                            <div class="col-md-4">
                                <label>Fecha de Nacimiento</label>
                                <input type="text" value="{{ persona.fecha_nacimiento|date:'Y-m-d' }}"
                                    class="form-control" readonly style="background-color: #2a2f3b;">
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="col-md-6">
                                <label>Tipo de Sangre (RH)</label>
                                <input type="text" value="{{ persona.get_rh_display }}" class="form-control" readonly
                                    style="background-color: #2a2f3b;">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Informaci√≥n Personal (EDITABLE) -->
                <div class="card mb-3">
                    <div class="card-header bg-info text-white">
                        <h6 class="mb-0">Informaci√≥n Personal (Editable)</h6>
                    </div>
                    <div class="card-body">
                        <div class="row mb-2">
                            <div class="col">
                                <label>Primer Nombre <span class="text-muted">(No editable)</span></label>
                                <input type="text" name="nom1_persona" id="nom1" class="form-control"
                                    value="{{ persona.nom1_persona }}" readonly style="background-color: #e9ecef;">
                                <div class="text-muted small">Este campo no se puede modificar en renovaciones</div>
                            </div>
                            <div class="col">
                                <label>Segundo Nombre <span class="text-muted">(No editable)</span></label>
                                <input type="text" name="nom2_persona" id="nom2" class="form-control"
                                    value="{{ persona.nom2_persona|default:'' }}" readonly style="background-color: #e9ecef;">
                                <div class="text-muted small">Este campo no se puede modificar en renovaciones</div>
                            </div>
                        </div>
                        <div class="row mb-2">
                            <div class="col">
                                <label>Primer Apellido <span class="text-muted">(No editable)</span></label>
                                <input type="text" name="ape1_persona" id="ape1" class="form-control"
                                    value="{{ persona.ape1_persona }}" readonly style="background-color: #e9ecef;">
                                <div class="text-muted small">Este campo no se puede modificar en renovaciones</div>
                            </div>
                            <div class="col">
                                <label>Segundo Apellido <span class="text-muted">(No editable)</span></label>
                                <input type="text" name="ape2_persona" id="ape2" class="form-control"
                                    value="{{ persona.ape2_persona|default:'' }}" readonly style="background-color: #e9ecef;">
                                <div class="text-muted small">Este campo no se puede modificar en renovaciones</div>
                            </div>
                        </div>

                        <div class="row mb-2">
                            <div class="col">
                                <label class="required-field">Direcci√≥n</label>
                                <input type="text" name="direc_persona" id="direc" class="form-control"
                                    value="{{ persona.direc_persona|default:'' }}" required>
                                <div class="invalid-feedback">M√°ximo 40 caracteres permitidos</div>
                            </div>
                            <div class="col">
                                <label class="required-field">Tel√©fono</label>
                                <input type="tel" name="tel_persona" id="tel" class="form-control"
                                    value="{{ persona.tel_persona|default:'' }}" required>
                                <div class="invalid-feedback">Debe tener exactamente 10 d√≠gitos</div>
                            </div>
                        </div>

                        <div class="row mb-2">
                            <div class="col">
                                <label class="required-field">Email</label>
                                <input type="email" name="email_persona" id="email" class="form-control"
                                    value="{{ persona.email_persona|default:'' }}" required>
                                <div class="invalid-feedback">Formato de email inv√°lido o m√°ximo 40 caracteres</div>
                            </div>
                            <div class="col">
                                <label class="required-field">G√©nero</label>
                                <select name="genero" id="genero" class="form-select" required>
                                    <option value="">Seleccionar</option>
                                    {% for genero in generos %}
                                    <option value="{{ genero.0 }}" 
                                        {% if persona.genero == genero.0 %}selected{% endif %}>
                                        {{ genero.1 }}
                                    </option>
                                    {% endfor %}
                                </select>
                                <div class="invalid-feedback">Por favor selecciona un g√©nero</div>
                            </div>
                        </div>
                        

                        <div class="row mb-2">
                            <div class="col">
                                <label class="required-field">EPS</label>
                                <select name="eps" id="eps" class="form-select" required>
                                    <option value="">Seleccionar</option>
                                    {% for ep in eps %}
                                    <option value="{{ ep.0 }}" 
                                        {% if persona.eps == ep.0 %}selected{% endif %}>
                                        {{ ep.1 }}
                                    </option>
                                    {% endfor %}
                                </select>
                                <div class="invalid-feedback">Por favor selecciona una EPS</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Medidas F√≠sicas (EDITABLE) -->
                <div class="row mb-2">
                    <div class="col">
                        <label>Altura (metros)</label>
                        <input type="text" name="altura" id="altura" class="form-control numeric-input"
                            value="{% if alumno.altura_metros %}{{ alumno.altura_metros }}{% endif %}"
                            placeholder="Ej: 1.65" data-decimal="true">
                        <div class="invalid-feedback">La altura debe estar entre 0.5 y 2.5 metros (use punto para
                            decimales)</div>
                    </div>
                    <div class="col">
                        <label>Peso (kg)</label>
                        <input type="text" name="peso" id="peso" class="form-control numeric-input"
                            value="{% if alumno.peso_medidas %}{{ alumno.peso_medidas }}{% endif %}"
                            placeholder="Ej: 55.5" data-decimal="true">
                        <div class="invalid-feedback">El peso debe estar entre 10 y 150 kg (use punto para decimales)
                        </div>
                    </div>
                    <div class="col">
                        <label>IMC (autom√°tico)</label>
                        <input type="text" name="imc" id="imc" class="form-control" readonly
                            style="background-color: #2a2f3b;"
                            value="{% if alumno.imc_medidas %}{{ alumno.imc_medidas }}{% endif %}">
                    </div>
                </div>

                <div class="row mb-2">
                    <div class="col">
                        <label>Talla de calzado</label>
                        <input type="text" name="calzado" id="calzado" class="form-control numeric-input"
                            value="{% if alumno.calzado %}{{ alumno.calzado }}{% endif %}" placeholder="Ej: 38"
                            data-decimal="false">
                        <div class="invalid-feedback">La talla debe estar entre 15 y 50 (solo n√∫meros enteros)</div>
                    </div>
                </div>

                <!-- Informaci√≥n Deportiva (NO EDITABLE) -->
<div class="card mb-3">
    <div class="card-header bg-success text-white">
        <h6 class="mb-0">Informaci√≥n Deportiva (No editable)</h6>
    </div>
    <div class="card-body">
        <div class="row mb-2">
            <div class="col">
                <label>Categor√≠a <span class="text-muted">(Asignada autom√°ticamente)</span></label>
                <input type="text" class="form-control" 
                    value="{{ categoria_sugerida.nom_categoria|default:'Categor√≠a asignada por edad' }}" 
                    readonly style="background-color: #e9ecef;">
                <!-- Campo hidden con el valor REAL que se enviar√° -->
                <input type="hidden" name="categoria" value="{{ categoria_sugerida.idcategoria|default:'' }}">
                <div class="text-muted small">Categor√≠a asignada seg√∫n tu edad ({{ edad }} a√±os)</div>
            </div>
            <div class="col">
                <label>Posici√≥n <span class="text-muted">(No editable)</span></label>
                <input type="text" class="form-control" 
                    value="{{ alumno.fk_posicion.nom_posicion|default:'Sin posici√≥n asignada' }}" 
                    readonly style="background-color: #e9ecef;">
                <!-- Campo hidden con el valor REAL que se enviar√° -->
                <input type="hidden" name="posicion" value="{{ alumno.fk_posicion.idposicion|default:'' }}">
                <div class="text-muted small">La posici√≥n no se puede modificar en renovaciones</div>
            </div>
        </div>
    </div>
</div>

                
                <!-- Informaci√≥n del Acudiente (EDITABLE) -->
<div class="card mb-3">
    <div class="card-header bg-primary text-white">
        <h6 class="mb-0">Informaci√≥n del Acudiente (Editable)</h6>
    </div>
    <div class="card-body">
        <div class="row mb-2">
            <div class="col">
                <label class="required-field">ID del Acudiente</label>
                <!-- Campo EDITABLE para modificar el ID -->
                <input type="text" name="idacudiente" id="idacudiente" class="form-control"
                    value="{% if alumno.fk_acudiente %}{{ alumno.fk_acudiente.idacudiente }}{% endif %}"
                    placeholder="Ingrese el ID del acudiente" required>
                <div class="invalid-feedback">El ID del acudiente es requerido (6-10 d√≠gitos)</div>
                <div class="text-muted small">N√∫mero de identificaci√≥n del acudiente</div>
            </div>
        </div>
        
        <div class="row mb-2">
            <div class="col">
                <label>Primer Nombre Acudiente</label>
                <input type="text" name="nom1_acudiente" id="nom1_acudiente" class="form-control"
                    value="{% if alumno.fk_acudiente %}{{ alumno.fk_acudiente.nom1_acudiente|default:'' }}{% endif %}">
                <div class="invalid-feedback">Solo letras, m√°ximo 20 caracteres</div>
            </div>
            <div class="col">
                <label>Segundo Nombre Acudiente</label>
                <input type="text" name="nom2_acudiente" id="nom2_acudiente" class="form-control"
                    value="{% if alumno.fk_acudiente %}{{ alumno.fk_acudiente.nom2_acudiente|default:'' }}{% endif %}">
                <div class="invalid-feedback">Solo letras, m√°ximo 20 caracteres</div>
            </div>
        </div>
        
        <div class="row mb-2">
            <div class="col">
                <label>Primer Apellido Acudiente</label>
                <input type="text" name="ape1_acudiente" id="ape1_acudiente" class="form-control"
                    value="{% if alumno.fk_acudiente %}{{ alumno.fk_acudiente.ape1_acudiente|default:'' }}{% endif %}">
                <div class="invalid-feedback">Solo letras, m√°ximo 20 caracteres</div>
            </div>
            <div class="col">
                <label>Segundo Apellido Acudiente</label>
                <input type="text" name="ape2_acudiente" id="ape2_acudiente" class="form-control"
                    value="{% if alumno.fk_acudiente %}{{ alumno.fk_acudiente.ape2_acudiente|default:'' }}{% endif %}">
                <div class="invalid-feedback">Solo letras, m√°ximo 20 caracteres</div>
            </div>
        </div>
        
        <div class="row mb-2">
            <div class="col">
                <label class="required-field">Tel√©fono Acudiente</label>
                <input type="tel" name="tel_acudiente" id="telacud" class="form-control"
                    value="{% if alumno.fk_acudiente %}{{ alumno.fk_acudiente.tel_acudiente|default:'' }}{% endif %}" required>
                <div class="invalid-feedback">Debe tener exactamente 10 d√≠gitos</div>
            </div>
        </div>
        
        <div class="row mb-2">
            <div class="col">
                <label>Parentesco</label>
                <select name="parentesco" id="parentesco" class="form-select">
                    <option value="">Seleccionar</option>
                    {% for parent in parentescos %}
                    <option value="{{ parent.0 }}" 
                        {% if alumno.fk_acudiente and alumno.fk_acudiente.parentesco == parent.0 %}selected{% endif %}>
                        {{ parent.1 }}
                    </option>
                    {% endfor %}
                </select>
                <div class="invalid-feedback">Por favor selecciona un parentesco v√°lido</div>
            </div>
        </div>
    </div>
</div>

                <!-- Documentos (OBLIGATORIOS EN RENOVACI√ìN) -->
                <div class="card mb-3">
                    <div class="card-header bg-dark text-white">
                        <h6 class="mb-0">üìÅ Documentos (Todos obligatorios)</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="file-input-group">
                                    <label class="required-field">Tratamiento de Datos</label>
                                    <input type="file" name="tradatos" id="tradatos" class="form-control"
                                        accept=".pdf,.doc,.docx" required>
                                    <div class="file-requirements">Formatos: PDF, DOC, DOCX (M√°x. 5MB)</div>
                                    <div class="invalid-feedback">Este documento es obligatorio</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="file-input-group">
                                    <label class="required-field">Foto</label>
                                    <input type="file" name="foto" id="foto" class="form-control"
                                        accept=".jpg,.jpeg,.png" required>
                                    <div class="file-requirements">Formatos: JPG, JPEG, PNG (M√°x. 5MB)</div>
                                    <div class="invalid-feedback">La foto es obligatoria</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="file-input-group">
                                    <label class="required-field">Autorizaci√≥n M√©dica</label>
                                    <input type="file" name="automedica" id="automedica" class="form-control"
                                        accept=".pdf,.doc,.docx" required>
                                    <div class="file-requirements">Formatos: PDF, DOC, DOCX (M√°x. 5MB)</div>
                                    <div class="invalid-feedback">Este documento es obligatorio</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="file-input-group">
                                    <label class="required-field">Comprobante EPS</label>
                                    <input type="file" name="certeps" id="certeps" class="form-control"
                                        accept=".pdf,.doc,.docx" required>
                                    <div class="file-requirements">Formatos: PDF, DOC, DOCX (M√°x. 5MB)</div>
                                    <div class="invalid-feedback">Este documento es obligatorio</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="file-input-group">
                                    <label>Coloca el certificado si estabas matriculado en otra escuela de f√∫tbol:</label>
                                    <input type="file" name="otraescuela" id="otraescuela" class="form-control"
                                        accept=".pdf,.doc,.docx">
                                    <div class="file-requirements">Formatos: PDF, DOC, DOCX (M√°x. 5MB)</div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="file-input-group">
                                    <label class="required-field">Documento de identidad del alumno:</label>
                                    <input type="file" name="documento_identidad" id="documento_identidad" class="form-control"
                                        accept=".pdf,.doc,.docx" required>
                                    <div class="file-requirements">Formatos: PDF, DOC, DOCX (M√°x. 5MB)</div>
                                    <div class="invalid-feedback">Este documento es obligatorio</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn-enviar">Confirmar Renovaci√≥n {{ ano_siguiente }}</button>
            </form>

            <div style="text-align: center; margin-top: 20px;">
                <a href="{% url 'renovacion:logout' %}" class="btn-regresar">
                    Cerrar Sesi√≥n
                </a>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // ================= CONFIGURACI√ìN INICIAL =================
document.addEventListener('DOMContentLoaded', function () {
    console.log('üîí Inicializando sistema de renovaci√≥n...');
    
    // 1. Configurar sistema de seguridad
    inicializarSeguridad();
    
    // 2. Configurar inputs num√©ricos
    configurarInputsNumericos();
    
    // 3. Configurar c√°lculo del IMC
    configurarCalculoIMC();
    
    // 4. Configurar validaciones en tiempo real para TODOS los campos editables
    configurarValidacionesTiempoReal();
    
    // 5. Configurar env√≠o del formulario
    configurarEnvioFormulario();
    
    // 6. Configurar banner informativo
    configurarBannerInformativo();
    
    console.log('‚úÖ Sistema de renovaci√≥n inicializado correctamente');
});

// ================= SISTEMA DE SEGURIDAD =================
const TIEMPO_EXPIRACION = 60 * 60 * 1000; // 1 hora
let temporizadorExpiracion;

function inicializarSeguridad() {
    // Guardar tiempo de inicio
    const tiempoInicio = Date.now();
    localStorage.setItem('renovacion_inicio', tiempoInicio);
    
    // Configurar temporizador de expiraci√≥n
    temporizadorExpiracion = setTimeout(() => {
        cerrarSesionPorExpiracion();
    }, TIEMPO_EXPIRACION);
    
    // Detectar inactividad
    let tiempoUltimaActividad = Date.now();
    
    const eventosActividad = ['mousemove', 'keypress', 'click', 'scroll', 'touchstart', 'input'];
    eventosActividad.forEach(evento => {
        document.addEventListener(evento, () => {
            tiempoUltimaActividad = Date.now();
        });
    });
    
    // Verificar inactividad cada minuto
    setInterval(() => {
        const tiempoInactivo = Date.now() - tiempoUltimaActividad;
        const LIMITE_INACTIVIDAD = 30 * 60 * 1000; // 30 minutos
        
        if (tiempoInactivo > LIMITE_INACTIVIDAD) {
            cerrarSesionPorInactividad();
        }
    }, 60000);
}

function cerrarSesionPorExpiracion() {
    clearTimeout(temporizadorExpiracion);
    localStorage.removeItem('renovacion_inicio');
    
    Swal.fire({
        title: '‚è∞ Sesi√≥n expirada',
        html: 'Tu sesi√≥n ha expirado por inactividad.<br><br>Ser√°s redirigido al inicio de sesi√≥n.',
        icon: 'info',
        confirmButtonText: 'OK',
        allowOutsideClick: false,
        allowEscapeKey: false
    }).then(() => {
        window.location.href = "{% url 'renovacion:logout' %}";
    });
}

function cerrarSesionPorInactividad() {
    clearTimeout(temporizadorExpiracion);
    localStorage.removeItem('renovacion_inicio');
    
    Swal.fire({
        title: 'üò¥ Sesi√≥n inactiva',
        html: 'Has estado inactivo por m√°s de 30 minutos.<br><br>Por seguridad, tu sesi√≥n ha sido cerrada.',
        icon: 'warning',
        confirmButtonText: 'Volver a iniciar sesi√≥n',
        allowOutsideClick: false,
        allowEscapeKey: false
    }).then(() => {
        window.location.href = "{% url 'renovacion:logout' %}";
    });
}

// ================= VALIDACIONES EN TIEMPO REAL =================
function configurarInputsNumericos() {
    const inputs = document.querySelectorAll('#altura, #peso, #calzado');

    inputs.forEach(input => {
        input.addEventListener('input', function (e) {
            let valor = this.value;
            valor = valor.replace(',', '.');
            
            // Permitir n√∫meros y punto decimal
            if (this.id === 'calzado') {
                // Para calzado solo n√∫meros enteros
                if (!/^\d*$/.test(valor)) {
                    this.value = valor.replace(/[^\d]/g, '');
                }
            } else {
                // Para altura y peso, permitir decimales
                if (!/^\d*\.?\d*$/.test(valor)) {
                    this.value = valor.replace(/[^\d.]/g, '').replace(/(\..*)\./g, '$1');
                }
            }
        });
    });
}

function configurarValidacionesTiempoReal() {
    // Lista de todos los campos editables que necesitan validaci√≥n
    const camposEditables = [
        // Campos de persona
        {id: 'direc', tipo: 'texto', maxLength: 40, requerido: true, nombre: 'Direcci√≥n'},
        {id: 'tel', tipo: 'telefono', requerido: true, nombre: 'Tel√©fono'},
        {id: 'email', tipo: 'email', maxLength: 40, requerido: true, nombre: 'Email'},
        {id: 'genero', tipo: 'select', requerido: true, nombre: 'G√©nero'},
        {id: 'eps', tipo: 'select', requerido: true, nombre: 'EPS'},
        
        // Campos de medidas f√≠sicas
        {id: 'altura', tipo: 'altura', requerido: false, nombre: 'Altura'},
        {id: 'peso', tipo: 'peso', requerido: false, nombre: 'Peso'},
        {id: 'calzado', tipo: 'calzado', requerido: false, nombre: 'Talla de calzado'},
        
        // Campos de acudiente
        {id: 'idacudiente', tipo: 'id_acudiente', requerido: true, nombre: 'ID del acudiente'},
        {id: 'nom1_acudiente', tipo: 'nombre', maxLength: 20, requerido: false, nombre: 'Primer nombre acudiente'},
        {id: 'nom2_acudiente', tipo: 'nombre', maxLength: 20, requerido: false, nombre: 'Segundo nombre acudiente'},
        {id: 'ape1_acudiente', tipo: 'apellido', maxLength: 20, requerido: false, nombre: 'Primer apellido acudiente'},
        {id: 'ape2_acudiente', tipo: 'apellido', maxLength: 20, requerido: false, nombre: 'Segundo apellido acudiente'},
        {id: 'telacud', tipo: 'telefono', requerido: true, nombre: 'Tel√©fono acudiente'},
        {id: 'email_acudiente', tipo: 'email', maxLength: 40, requerido: false, nombre: 'Email acudiente'},
        {id: 'parentesco', tipo: 'select', requerido: false, nombre: 'Parentesco'},
        
        // Archivos
        {id: 'tradatos', tipo: 'archivo', requerido: true, nombre: 'Tratamiento de datos', formatos: ['.pdf', '.doc', '.docx'], tamano: 5},
        {id: 'foto', tipo: 'archivo', requerido: true, nombre: 'Foto', formatos: ['.jpg', '.jpeg', '.png'], tamano: 5},
        {id: 'automedica', tipo: 'archivo', requerido: true, nombre: 'Autorizaci√≥n m√©dica', formatos: ['.pdf', '.doc', '.docx'], tamano: 5},
        {id: 'certeps', tipo: 'archivo', requerido: true, nombre: 'Comprobante EPS', formatos: ['.pdf', '.doc', '.docx'], tamano: 5},
        {id: 'documento_identidad', tipo: 'archivo', requerido: true, nombre: 'Documento de identidad', formatos: ['.pdf', '.doc', '.docx'], tamano: 5},
        {id: 'otraescuela', tipo: 'archivo', requerido: false, nombre: 'Certificado otra escuela', formatos: ['.pdf', '.doc', '.docx'], tamano: 5}
    ];
    
    camposEditables.forEach(campoConfig => {
        const campo = document.getElementById(campoConfig.id);
        if (campo) {
            // Configurar evento blur (cuando pierde el foco)
            campo.addEventListener('blur', function() {
                validarCampoTiempoReal(this, campoConfig);
            });
            
            // Configurar evento input (mientras escribe) para campos de texto
            if (campoConfig.tipo !== 'archivo' && campoConfig.tipo !== 'select') {
                campo.addEventListener('input', function() {
                    limpiarValidacionVisual(this);
                });
            }
            
            // Para archivos, validar cuando cambian
            if (campoConfig.tipo === 'archivo') {
                campo.addEventListener('change', function() {
                    validarCampoTiempoReal(this, campoConfig);
                });
            }
            
            // Para selects, validar cuando cambian
            if (campoConfig.tipo === 'select') {
                campo.addEventListener('change', function() {
                    validarCampoTiempoReal(this, campoConfig);
                });
                
                // Validar al cargar la p√°gina si ya tiene valor
                if (campo.value) {
                    setTimeout(() => {
                        validarCampoTiempoReal(campo, campoConfig);
                    }, 100);
                }
            }
        }
    });
}

function validarCampoTiempoReal(campo, config) {
    limpiarValidacionVisual(campo);
    
    const valor = campo.value.trim();
    const archivos = campo.files;
    
    // Validar campo requerido
    if (config.requerido) {
        if (config.tipo === 'archivo') {
            if (!archivos || archivos.length === 0) {
                mostrarErrorVisual(campo, `El ${config.nombre} es obligatorio`);
                return false;
            }
        } else if (!valor) {
            mostrarErrorVisual(campo, `El ${config.nombre} es obligatorio`);
            return false;
        }
    }
    
    // Si no es requerido y est√° vac√≠o, est√° bien
    if (!config.requerido && !valor && config.tipo !== 'archivo') {
        return true;
    }
    
    // Validaciones espec√≠ficas por tipo
    switch(config.tipo) {
        case 'telefono':
            if (valor && !/^\d{10}$/.test(valor)) {
                mostrarErrorVisual(campo, 'Debe tener exactamente 10 d√≠gitos');
                return false;
            }
            break;
            
        case 'email':
            if (valor && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(valor)) {
                mostrarErrorVisual(campo, 'Formato de email inv√°lido');
                return false;
            }
            if (valor && config.maxLength && valor.length > config.maxLength) {
                mostrarErrorVisual(campo, `M√°ximo ${config.maxLength} caracteres`);
                return false;
            }
            break;
            
        case 'texto':
            if (config.maxLength && valor.length > config.maxLength) {
                mostrarErrorVisual(campo, `M√°ximo ${config.maxLength} caracteres`);
                return false;
            }
            break;
        
        case 'nombre':
        case 'apellido':
            if (valor && !/^[A-Za-z√Å√â√ç√ì√ö√°√©√≠√≥√∫√ë√±\s]+$/.test(valor)) {
                mostrarErrorVisual(campo, 'Solo letras y espacios');
                return false;
            }
            if (config.maxLength && valor.length > config.maxLength) {
                mostrarErrorVisual(campo, `M√°ximo ${config.maxLength} caracteres`);
                return false;
            }
            break;
            
        case 'altura':
            if (valor) {
                const alturaNum = parseFloat(valor.replace(',', '.'));
                if (isNaN(alturaNum) || alturaNum < 0.5 || alturaNum > 2.5) {
                    mostrarErrorVisual(campo, 'Debe estar entre 0.5 y 2.5 metros');
                    return false;
                }
            }
            break;
            
        case 'peso':
            if (valor) {
                const pesoNum = parseFloat(valor.replace(',', '.'));
                if (isNaN(pesoNum) || pesoNum < 10 || pesoNum > 150) {
                    mostrarErrorVisual(campo, 'Debe estar entre 10 y 150 kg');
                    return false;
                }
            }
            break;
            
        case 'calzado':
            if (valor) {
                const calzadoNum = parseInt(valor);
                if (isNaN(calzadoNum) || calzadoNum < 15 || calzadoNum > 50) {
                    mostrarErrorVisual(campo, 'Debe estar entre 15 y 50');
                    return false;
                }
            }
            break;
            
        case 'id_acudiente':
            if (valor) {
                // Validar que solo contenga n√∫meros
                if (!/^\d+$/.test(valor)) {
                    mostrarErrorVisual(campo, 'Solo puede contener n√∫meros');
                    return false;
                }
                // Validar longitud (entre 6 y 10 d√≠gitos)
                if (valor.length < 6 || valor.length > 10) {
                    mostrarErrorVisual(campo, 'Debe tener entre 6 y 10 d√≠gitos');
                    return false;
                }
            }
            break;
            
        case 'select':
            if (config.requerido && !valor) {
                mostrarErrorVisual(campo, `Por favor selecciona un ${config.nombre.toLowerCase()}`);
                return false;
            }
            break;
            
        case 'archivo':
            if (archivos && archivos.length > 0) {
                const archivo = archivos[0];
                
                // Validar tama√±o (MB)
                const tamanoMaximo = (config.tamano || 5) * 1024 * 1024;
                if (archivo.size > tamanoMaximo) {
                    mostrarErrorVisual(campo, `El archivo es demasiado grande (m√°ximo ${config.tamano || 5}MB)`);
                    return false;
                }
                
                // Validar extensi√≥n
                const nombreArchivo = archivo.name.toLowerCase();
                let extensionValida = false;
                
                if (config.formatos) {
                    for (const formato of config.formatos) {
                        if (nombreArchivo.endsWith(formato.toLowerCase())) {
                            extensionValida = true;
                            break;
                        }
                    }
                    
                    if (!extensionValida) {
                        mostrarErrorVisual(campo, `Formatos permitidos: ${config.formatos.join(', ')}`);
                        return false;
                    }
                }
            }
            break;
    }
    
    // Si pasa todas las validaciones
    mostrarExitoVisual(campo);
    return true;
}

function mostrarErrorVisual(campo, mensaje) {
    campo.classList.add('is-invalid');
    campo.classList.remove('is-valid');
    
    // Buscar o crear el mensaje de error
    let feedback = campo.nextElementSibling;
    while (feedback && !feedback.classList.contains('invalid-feedback')) {
        feedback = feedback.nextElementSibling;
    }
    
    if (!feedback || !feedback.classList.contains('invalid-feedback')) {
        feedback = document.createElement('div');
        feedback.className = 'invalid-feedback';
        campo.parentNode.appendChild(feedback);
    }
    
    feedback.textContent = mensaje;
    feedback.style.display = 'block';
}

function mostrarExitoVisual(campo) {
    campo.classList.add('is-valid');
    campo.classList.remove('is-invalid');
    
    // Ocultar mensaje de error si existe
    let feedback = campo.nextElementSibling;
    while (feedback && !feedback.classList.contains('invalid-feedback')) {
        feedback = feedback.nextElementSibling;
    }
    
    if (feedback && feedback.classList.contains('invalid-feedback')) {
        feedback.style.display = 'none';
    }
}

function limpiarValidacionVisual(campo) {
    campo.classList.remove('is-invalid', 'is-valid');
    
    // Ocultar mensaje de error si existe
    let feedback = campo.nextElementSibling;
    while (feedback && !feedback.classList.contains('invalid-feedback')) {
        feedback = feedback.nextElementSibling;
    }
    
    if (feedback && feedback.classList.contains('invalid-feedback')) {
        feedback.style.display = 'none';
    }
}

function configurarCalculoIMC() {
    const alturaInput = document.getElementById('altura');
    const pesoInput = document.getElementById('peso');
    const imcInput = document.getElementById('imc');

    function calcularIMC() {
        let altura = alturaInput.value;
        let peso = pesoInput.value;

        altura = altura.replace(',', '.');
        peso = peso.replace(',', '.');

        const alturaNum = parseFloat(altura) || 0;
        const pesoNum = parseFloat(peso) || 0;

        if (alturaNum > 0 && pesoNum > 0) {
            const imc = pesoNum / (alturaNum * alturaNum);
            imcInput.value = imc.toFixed(2);
        } else {
            imcInput.value = '';
        }
    }

    if (alturaInput && pesoInput && imcInput) {
        alturaInput.addEventListener('input', calcularIMC);
        pesoInput.addEventListener('input', calcularIMC);
    }
}

// ================= CONFIGURACI√ìN DE ENV√çO DEL FORMULARIO =================
function configurarEnvioFormulario() {
    const formulario = document.getElementById('renovacionForm');
    if (!formulario) return;

    formulario.addEventListener('submit', function (e) {
        e.preventDefault(); // Siempre prevenir env√≠o por defecto
        
        // Verificar sesi√≥n
        const tiempoInicio = localStorage.getItem('renovacion_inicio');
        if (!tiempoInicio) {
            Swal.fire({
                title: 'Sesi√≥n expirada',
                text: 'Tu sesi√≥n ha expirado. Por favor, inicia sesi√≥n nuevamente.',
                icon: 'error',
                confirmButtonText: 'Iniciar sesi√≥n'
            }).then(() => {
                window.location.href = "{% url 'renovacion:login' %}";
            });
            return;
        }

        // Validar TODOS los campos antes de enviar
        const errores = [];
        const camposInvalidos = formulario.querySelectorAll('.is-invalid');
        
        if (camposInvalidos.length > 0) {
            Swal.fire({
                icon: 'error',
                title: 'Errores en el formulario',
                text: 'Por favor corrige los errores marcados en rojo antes de enviar.',
                confirmButtonColor: '#dc3545'
            });
            
            // Desplazarse al primer error
            const primerError = camposInvalidos[0];
            primerError.scrollIntoView({ behavior: 'smooth', block: 'center' });
            primerError.focus();
            return;
        }
        
        // Verificar campos requeridos
        const camposRequeridos = [
            {id: 'direc', nombre: 'Direcci√≥n'},
            {id: 'tel', nombre: 'Tel√©fono'},
            {id: 'email', nombre: 'Email'},
            {id: 'eps', nombre: 'EPS'},
            {id: 'genero', nombre: 'G√©nero'},
            {id: 'telacud', nombre: 'Tel√©fono del acudiente'},
            {id: 'idacudiente', nombre: 'ID del acudiente'},
            {id: 'tradatos', nombre: 'Tratamiento de datos'},
            {id: 'foto', nombre: 'Foto'},
            {id: 'automedica', nombre: 'Autorizaci√≥n m√©dica'},
            {id: 'certeps', nombre: 'Comprobante EPS'},
            {id: 'documento_identidad', nombre: 'Documento de identidad'}
        ];
        
        camposRequeridos.forEach(campo => {
            const elemento = document.getElementById(campo.id);
            if (elemento) {
                if (elemento.type === 'file') {
                    if (!elemento.files || elemento.files.length === 0) {
                        errores.push(campo.nombre);
                        mostrarErrorVisual(elemento, 'Este campo es obligatorio');
                    }
                } else if (!elemento.value.trim()) {
                    errores.push(campo.nombre);
                    mostrarErrorVisual(elemento, 'Este campo es obligatorio');
                }
            }
        });
        
        if (errores.length > 0) {
            Swal.fire({
                icon: 'warning',
                title: 'Campos obligatorios',
                html: `Por favor completa los siguientes campos:<br><strong>${errores.join(', ')}</strong>`,
                confirmButtonColor: '#3085d6'
            });
            return;
        }
        
        // Mostrar confirmaci√≥n antes de enviar
        Swal.fire({
            title: '¬øConfirmar renovaci√≥n?',
            html: `¬øEst√°s seguro de renovar tu matr√≠cula para el a√±o <strong>${new Date().getFullYear() + 1}</strong>?<br><br>Una vez enviado, no podr√°s modificar los datos.`,
            icon: 'question',
            showCancelButton: true,
            confirmButtonText: 'S√≠, renovar matr√≠cula',
            cancelButtonText: 'Cancelar',
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33'
        }).then((result) => {
            if (result.isConfirmed) {
                // Deshabilitar bot√≥n de env√≠o
                const botonEnviar = formulario.querySelector('button[type="submit"]');
                if (botonEnviar) {
                    botonEnviar.disabled = true;
                    botonEnviar.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Procesando...';
                }
                
                // Enviar formulario
                formulario.submit();
            }
        });
    });
}

// ================= BANNER INFORMATIVO =================
function configurarBannerInformativo() {
    const banner = document.getElementById('infoBanner');
    const closeButton = document.getElementById('closeBanner');
    
    if (!banner) return;
    
    // Verificar si el usuario ya cerr√≥ el banner antes
    const bannerCerrado = localStorage.getItem('renovacion_banner_cerrado');
    
    if (bannerCerrado) {
        banner.style.display = 'none';
        const page = document.querySelector('.page');
        if (page) {
            page.style.marginTop = '0';
        }
    }
    
    // Configurar bot√≥n de cerrar
    if (closeButton) {
        closeButton.addEventListener('click', function() {
            banner.style.display = 'none';
            const page = document.querySelector('.page');
            if (page) {
                page.style.marginTop = '0';
            }
            localStorage.setItem('renovacion_banner_cerrado', 'true');
        });
    }
    
    // Tambi√©n cerrar el banner despu√©s de 30 segundos autom√°ticamente
    setTimeout(() => {
        if (banner && banner.style.display !== 'none') {
            banner.style.animation = 'slideUp 0.5s ease-out';
            setTimeout(() => {
                banner.style.display = 'none';
                const page = document.querySelector('.page');
                if (page) {
                    page.style.marginTop = '0';
                }
            }, 500);
        }
    }, 30000);
}

// A√±adir el CSS para la animaci√≥n de slideUp
const style = document.createElement('style');
style.textContent = `
@keyframes slideUp {
    from {
        transform: translateY(0);
        opacity: 1;
    }
    to {
        transform: translateY(-100%);
        opacity: 0;
    }
}
`;
document.head.appendChild(style);
</script>
</body>

</html>